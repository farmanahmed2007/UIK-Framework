var app_cardealer_widget_quicksearch=null;jQuery(document).ready(function(){app_cardealer_widget_quicksearch=new THEMEMAKERS_APP_CARDEALER_WIDGET_QUICKSEARCH,app_cardealer_widget_quicksearch.init()});var THEMEMAKERS_APP_CARDEALER_WIDGET_QUICKSEARCH=function(){var a={init:function(){jQuery(".qs_carlocation0").life("change",function(){var e=jQuery(this).val(),r=jQuery(this).parents(".quicksearch-container"),c=r.find(".qs_condition").val(),n=r.find(".qs_carlocation1"),i=r.find(".qs_carlocation2");a.clear_select(i),i.attr("disabled",!0),0==e&&0==c?(a.clear_select(n),n.attr("disabled",!0),a.load_producers(r)):(n.attr("disabled",!0).val(0),a.load_locations(e,0,r))}),jQuery(".qs_carlocation1").life("change",function(){var e=jQuery(this).data("level"),r=jQuery(this).val(),c=jQuery(this).parents(".quicksearch-container"),n=c.find(".qs_carlocation2");"0"===r?(a.clear_select(n),n.attr("disabled",!0),a.load_producers(c)):(a.load_locations(r,e,c),n.attr("disabled",!1))}),jQuery(".qs_carlocation2").life("change",function(){var e=jQuery(this).parents(".quicksearch-container");a.load_producers(e)}),"0"!==jQuery(".qs_carlocation1").val()&&jQuery(".qs_carlocation2").attr("disabled",!1).parent().removeClass("active"),jQuery(".qs_carproducer").life("change",function(){var e=jQuery(this).parents(".quicksearch-container");a.load_models(e)}),jQuery(".car_adv_search_btn").life("click",function(){var a=jQuery(this),e=jQuery(this).parents(".quicksearch-container");return e.find(".car_adv_search").slideToggle(400,function(){var e=jQuery(this);e.hasClass("hide")?(e.removeClass("hide").addClass("show"),a.parent().addClass("active")):(e.removeClass("show").addClass("hide"),a.parent().removeClass("active"))}),!1}),jQuery(".submit-search").click(function(){var e=jQuery(this).parents(".quicksearch-container");return a.search(e),!1})},load_producers:function(e){var r=e.find(".qs_carproducer"),c=e.find(".qs_carmodel"),n=e.find(".qs_carlocation0"),i=n.val(),o=0,t=0,l=0;loader=e.find(".quicksearch_load_area"),loader.show(),a.clear_select(c),r.attr("disabled",!0),c.attr("disabled",!0),e.find(".carlocations").each(function(){$this=jQuery(this),l="hidden"==$this.attr("type")?$this.val():jQuery(this).find("option:selected").val(),l>0&&(t++,o=l)});var d={action:"app_cardealer_draw_quicksearch_producers",location_id:i,selected_region_id:o,level:t};jQuery.post(ajaxurl,d,function(e){a.clear_select(r),a.clear_select(c),r.append(e).attr("disabled",!1),c.attr("disabled",!0),loader.hide()})},load_models:function(e){var r=e.find(".qs_carproducer").val(),c=e.find(".qs_carmodel"),n=e.find(".qs_carlocation0").val(),i=0,o=0,t=e.find(".quicksearch_load_area"),l=0;if(t.show(),c.attr("disabled",!0),0==r)return a.clear_select(c),void t.hide();e.find(".carlocations").each(function(a,e){$this=jQuery(e),l="hidden"==$this.attr("type")?$this.val():$this.find("option:selected").val(),l>0&&(o++,i=l)});var d={action:"app_cardealer_draw_quicksearch_models",location_id:n,selected_region_id:i,producer_id:r,level:o};jQuery.post(ajaxurl,d,function(e){a.clear_select(c),c.append(e).attr("disabled",!1).parent(".sel").removeClass("disabled"),t.hide()})},load_locations:function(e,r,c){var n=c.find(".quicksearch_load_area");n.show();var i={action:"app_cardealer_draw_quicksearch_locations",parent_id:e,level:r+1};jQuery.post(ajaxurl,i,function(e){var i=c.find(".qs_carlocation"+(r+1));a.clear_select(i),i.append(e).removeAttr("disabled").parent(".sel").removeClass("disabled"),n.hide()}),a.load_producers(c)},search:function(a){var e=a.find(".car_form_search"),r=e.attr("action"),c={car_condition:a.find(".qs_condition").length?a.find(".qs_condition").val():"0",carlocation:"0",carproducer:a.find(".qs_carproducer").length?a.find(".qs_carproducer").val():"0",carmodels:a.find(".qs_carmodel").length?a.find(".qs_carmodel").val():"0",car_price_min:a.find("[name=car_price_min]").length?a.find("[name=car_price_min]").val():"0",car_price_max:a.find("[name=car_price_max]").length?a.find("[name=car_price_max]").val():"0",car_year_from:a.find("[name=car_year_from]").length?a.find("[name=car_year_from]").val():"0",car_year_to:a.find("[name=car_year_to]").length?a.find("[name=car_year_to]").val():"0",car_fuel_type:a.find("[name=car_fuel_type]").length?a.find("[name=car_fuel_type]").val():"0",car_body:a.find("[name=car_body]").length?a.find("[name=car_body]").val():"0",car_doors_count:a.find("[name=car_doors_count]").length?a.find("[name=car_doors_count]").val():"0",car_interrior_color:a.find("[name=car_interrior_color]").length?a.find("[name=car_interrior_color]").val():"0",car_exterior_color:a.find("[name=car_exterior_color]").length?a.find("[name=car_exterior_color]").val():"0",car_transmission:a.find("[name=car_transmission]").length?a.find("[name=car_transmission]").val():"0",car_mileage_from:a.find("[name=car_mileage_from]").length?a.find("[name=car_mileage_from]").val():"0",car_mileage_to:a.find("[name=car_mileage_to]").length?a.find("[name=car_mileage_to]").val():"0"},n=[a.find(".qs_carlocation0").length?a.find(".qs_carlocation0").val():"0",a.find(".qs_carlocation1").length?a.find(".qs_carlocation1").val():"0",a.find(".qs_carlocation2").length?a.find(".qs_carlocation2").val():"0"],i=0;r+=-1==r.indexOf("?")?"?":"&","0"!==n[0]&&(c.carlocation=n[0],"0"!==n[1]&&(c.carlocation+=","+n[1],"0"!==n[2]&&(c.carlocation+=","+n[2])));for(i in c)"0"!==c[i]&&(r=r+i+"="+c[i]+"&");var o={action:"app_cardealer_process_advanced_search_params",advanced_search_params:a.find(".advanced_car_search_panel").serialize()};jQuery.post(ajaxurl,o,function(a){window.location=r+"adv_params="+a})},clear_select:function(a){a.each(function(){jQuery(this).val(0).html('<option value="0">'+lang_any+"</option>")})}};return a};